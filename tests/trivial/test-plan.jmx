<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0" jmeter="5.5">
  <hashTree>

    <!-- ===================== TEST PLAN ===================== -->
    <TestPlan guiclass="TestPlanGui"
              testclass="TestPlan"
              testname="MAIN TEST PLAN"
              enabled="true">

      <elementProp name="TestPlan.user_defined_variables" elementType="Arguments">
        <collectionProp name="Arguments.arguments">

          <elementProp name="TARGET_PROTOCOL" elementType="Argument">
            <stringProp name="Argument.name">TARGET_PROTOCOL</stringProp>
            <stringProp name="Argument.value">https</stringProp>
          </elementProp>

          <elementProp name="TARGET_HOST" elementType="Argument">
            <stringProp name="Argument.name">TARGET_HOST</stringProp>
            <stringProp name="Argument.value">appcrm.datacrm.la</stringProp>
          </elementProp>

          <elementProp name="TARGET_PORT" elementType="Argument">
            <stringProp name="Argument.name">TARGET_PORT</stringProp>
            <stringProp name="Argument.value">443</stringProp>
          </elementProp>

          <elementProp name="TARGET_PATH" elementType="Argument">
            <stringProp name="Argument.name">TARGET_PATH</stringProp>
            <stringProp name="Argument.value">/datacrm/cpuniminuto/index.php</stringProp>
          </elementProp>

          <!-- CSRF token compartido entre fragmentos -->
          <elementProp name="csrfToken" elementType="Argument">
            <stringProp name="Argument.name">csrfToken</stringProp>
            <stringProp name="Argument.value"></stringProp>
          </elementProp>

        </collectionProp>
      </elementProp>
    </TestPlan>

    <hashTree>

      <!-- ===================== THREAD GROUP ===================== -->
      <ThreadGroup guiclass="ThreadGroupGui"
                   testclass="ThreadGroup"
                   testname="Main Thread Group"
                   enabled="true">

        <!-- ðŸ”¥ 200 usuarios concurrentes -->
        <stringProp name="ThreadGroup.num_threads">200</stringProp>

        <!-- ðŸ” Ramp-up controlado (20 segundos) -->
        <stringProp name="ThreadGroup.ramp_time">20</stringProp>

        <elementProp name="ThreadGroup.main_controller"
                     elementType="LoopController">
          <boolProp name="LoopController.continue_forever">false</boolProp>
          <stringProp name="LoopController.loops">1</stringProp>
        </elementProp>

      </ThreadGroup>

      <hashTree>

        <!-- ===================== LOGIN ===================== -->
        <IncludeController guiclass="IncludeControllerGui"
                           testclass="IncludeController"
                           testname="Include Login Fragment"
                           enabled="true">
          <stringProp name="IncludeController.includepath">
            tests/trivial/login-test-plan.jmx
          </stringProp>
        </IncludeController>
        <hashTree/>

        <!-- ===================== DASHBOARD ===================== -->
        <IncludeController guiclass="IncludeControllerGui"
                           testclass="IncludeController"
                           testname="Include Dashboard Fragment"
                           enabled="true">
          <stringProp name="IncludeController.includepath">
            tests/trivial/dashboard-test-plan.jmx
          </stringProp>
        </IncludeController>
        <hashTree/>

        <!-- ===================== CANVAS ===================== -->
        <IncludeController guiclass="IncludeControllerGui"
                           testclass="IncludeController"
                           testname="Include Canvas Fragment"
                           enabled="true">
          <stringProp name="IncludeController.includepath">
            tests/trivial/canvas-test-plan.jmx
          </stringProp>
        </IncludeController>
        <hashTree/>

        <!-- ===================== WHATSAPP ===================== -->
        <IncludeController guiclass="IncludeControllerGui"
                           testclass="IncludeController"
                           testname="Include WhatsApp Fragment"
                           enabled="true">
          <stringProp name="IncludeController.includepath">
            tests/trivial/whatsapp-test-plan.jmx
          </stringProp>
        </IncludeController>
        <hashTree/>

        <!-- ===================== CLI SAFE LISTENER ===================== -->
        <ResultCollector guiclass="ViewResultsFullVisualizer"
                         testclass="ResultCollector"
                         testname="CLI Safe Listener"
                         enabled="true"/>

      </hashTree>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
